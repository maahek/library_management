<!DOCTYPE html>
<html>
<head>
<title>Reports</title>
</head>

<body style="
margin:0;
font-family:Arial, sans-serif;
background-image:url('/static/css/library.jpeg');
">

<div style="display:flex; min-height:100vh;">

    <!-- SIDEBAR -->
    <div style="
    width:240px;
    background: #4b2e2e;
    color:white;
    padding:20px;
    ">

        <h2 style="margin-bottom:30px;">ðŸ“š Library</h2>

        <div style="margin:15px 0;">
            <a href="/home" style="color:white; text-decoration:none;">Home</a>
        </div>

        <div style="margin:15px 0;">
            <a href="/add_book" style="color:white; text-decoration:none;">Add Book</a>
        </div>

        <div style="margin:15px 0;">
            <a href="/issue_book" style="color:white; text-decoration:none;">Issue Book</a>
        </div>

        <div style="margin:15px 0;">
            <a href="/return_book" style="color:white; text-decoration:none;">Return Book</a>
        </div>

        <div style="margin:15px 0;">
            <a href="/members" style="color:white; text-decoration:none;">Members</a>
        </div>

        <div style="margin:15px 0;">
            <a href="/reports" style="color:white; text-decoration:none;">Reports</a>
        </div>

    </div>


    <!-- MAIN CONTENT -->
    <div style="
    flex:1;
    padding:30px;
    ">


        <!-- TOP CARDS -->
        <div style="
        display:flex;
        gap:20px;
        margin-bottom:30px;
        ">

            <div style="
            flex:1;
            background:rgb(79, 53, 53);
            color: white;
            padding:20px;
            border-radius:10px;
            text-align:center;
            ">
                <h3>Total Books</h3>
                <h2>{{ total_books }}</h2>
            </div>

            <div style="
            flex:1;
            background:rgb(79, 53, 53);
            color: white;
            padding:20px;
            border-radius:10px;
            text-align:center;
            ">
                <h3>Members</h3>
                <h2>{{ total_students }}</h2>
            </div>

            <div style="
            flex:1;
            background:rgb(79, 53, 53);
            color: white;
            padding:20px;
            border-radius:10px;
            text-align:center;
            ">
                <h3>Issued Books</h3>
                <h2>{{ issued_count }}</h2>
            </div>

            <div style="
            flex:1;
            background:rgb(79, 53, 53);
            color: white;
            padding:20px;
            border-radius:10px;
            text-align:center;
            ">
                <h3>Due Books</h3>
                <h2>{{ due_count }}</h2>
            </div>

        </div>



        <!-- BOTTOM SECTION -->
        <div style="
        display:flex;
        gap:20px;
        ">


            <!-- PIE CHART -->
            <div style="
            flex:1;
            background:#efdecd;
            padding:20px;
            border-radius:10px;
            ">

                <h3>Library Analytics</h3>

                <canvas id="chart" style="max-width:300px;"></canvas>

            </div>



            <!-- TABLE -->
            <div style="
            flex:2;
            
            padding:20px;
            border-radius:10px;
            background: #efdecd;
            box-shadow:0px 0px 20px rgba(0,0,0,0.6);
            ">

                <h3>Recent Issued Books</h3>

                <table style="
                width:100%;
                border-collapse:collapse;
                
                ">

                    <tr style="background:#4fd1c5; color:white;">
                        <th style="padding:10px;">Student</th>
                        <th>Book</th>
                        <th>Status</th>
                    </tr>

                    {% for r in records %}
                    <tr style="text-align:center;">
                        <td style="padding:10px;">{{ r[0] }}</td>
                        <td>{{ r[1] }}</td>
                        <td>{{ r[2] }}</td>
                    </tr>
                    {% endfor %}

                </table>

            </div>

        </div>


    </div>

</div>


<!-- CHART SCRIPT -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
new Chart(document.getElementById('chart'), {
    type: 'pie',
    data: {
        labels: ['Issued', 'Due'],
        datasets: [{
            data: [{{ issued_count }}, {{ due_count }}],
            backgroundColor: ['#36a2eb','#ff6384']
        }]
    }
});
</script>

</body>
</html>
